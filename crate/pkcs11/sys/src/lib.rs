// Copyright 2022 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Since code is autogenerated with bindgen from C to Rust, just ignore this clippy lints
#![allow(non_camel_case_types)]
#![allow(non_snake_case)]
#![allow(clippy::unreadable_literal)]

#[cfg(target_os = "windows")]
mod pkcs11_windows;
#[cfg(target_os = "windows")]
pub use pkcs11_windows::*;

#[cfg(target_os = "windows")]
pub const CK_UNAVAILABLE_INFORMATION: u32 = std::u32::MAX;

#[cfg(not(target_os = "windows"))]
mod pkcs11_unix;
#[cfg(not(target_os = "windows"))]
pub use pkcs11_unix::*;


pub fn get_ck_rv_name(value: CK_RV) -> &'static str {
    match value {
        0 => "CKR_OK",
        1 => "CKR_CANCEL",
        2 => "CKR_HOST_MEMORY",
        3 => "CKR_SLOT_ID_INVALID",
        5 => "CKR_GENERAL_ERROR",
        6 => "CKR_FUNCTION_FAILED",
        7 => "CKR_ARGUMENTS_BAD",
        8 => "CKR_NO_EVENT",
        9 => "CKR_NEED_TO_CREATE_THREADS",
        10 => "CKR_CANT_LOCK",
        16 => "CKR_ATTRIBUTE_READ_ONLY",
        17 => "CKR_ATTRIBUTE_SENSITIVE",
        18 => "CKR_ATTRIBUTE_TYPE_INVALID",
        19 => "CKR_ATTRIBUTE_VALUE_INVALID",
        27 => "CKR_ACTION_PROHIBITED",
        32 => "CKR_DATA_INVALID",
        33 => "CKR_DATA_LEN_RANGE",
        48 => "CKR_DEVICE_ERROR",
        49 => "CKR_DEVICE_MEMORY",
        50 => "CKR_DEVICE_REMOVED",
        64 => "CKR_ENCRYPTED_DATA_INVALID",
        65 => "CKR_ENCRYPTED_DATA_LEN_RANGE",
        66 => "CKR_AEAD_DECRYPT_FAILED",
        80 => "CKR_FUNCTION_CANCELED",
        81 => "CKR_FUNCTION_NOT_PARALLEL",
        84 => "CKR_FUNCTION_NOT_SUPPORTED",
        96 => "CKR_KEY_HANDLE_INVALID",
        98 => "CKR_KEY_SIZE_RANGE",
        99 => "CKR_KEY_TYPE_INCONSISTENT",
        100 => "CKR_KEY_NOT_NEEDED",
        101 => "CKR_KEY_CHANGED",
        102 => "CKR_KEY_NEEDED",
        103 => "CKR_KEY_INDIGESTIBLE",
        104 => "CKR_KEY_FUNCTION_NOT_PERMITTED",
        105 => "CKR_KEY_NOT_WRAPPABLE",
        106 => "CKR_KEY_UNEXTRACTABLE",
        112 => "CKR_MECHANISM_INVALID",
        113 => "CKR_MECHANISM_PARAM_INVALID",
        130 => "CKR_OBJECT_HANDLE_INVALID",
        144 => "CKR_OPERATION_ACTIVE",
        145 => "CKR_OPERATION_NOT_INITIALIZED",
        160 => "CKR_PIN_INCORRECT",
        161 => "CKR_PIN_INVALID",
        162 => "CKR_PIN_LEN_RANGE",
        163 => "CKR_PIN_EXPIRED",
        164 => "CKR_PIN_LOCKED",
        176 => "CKR_SESSION_CLOSED",
        177 => "CKR_SESSION_COUNT",
        179 => "CKR_SESSION_HANDLE_INVALID",
        180 => "CKR_SESSION_PARALLEL_NOT_SUPPORTED",
        181 => "CKR_SESSION_READ_ONLY",
        182 => "CKR_SESSION_EXISTS",
        183 => "CKR_SESSION_READ_ONLY_EXISTS",
        184 => "CKR_SESSION_READ_WRITE_SO_EXISTS",
        192 => "CKR_SIGNATURE_INVALID",
        193 => "CKR_SIGNATURE_LEN_RANGE",
        208 => "CKR_TEMPLATE_INCOMPLETE",
        209 => "CKR_TEMPLATE_INCONSISTENT",
        224 => "CKR_TOKEN_NOT_PRESENT",
        225 => "CKR_TOKEN_NOT_RECOGNIZED",
        226 => "CKR_TOKEN_WRITE_PROTECTED",
        240 => "CKR_UNWRAPPING_KEY_HANDLE_INVALID",
        241 => "CKR_UNWRAPPING_KEY_SIZE_RANGE",
        242 => "CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT",
        256 => "CKR_USER_ALREADY_LOGGED_IN",
        257 => "CKR_USER_NOT_LOGGED_IN",
        258 => "CKR_USER_PIN_NOT_INITIALIZED",
        259 => "CKR_USER_TYPE_INVALID",
        260 => "CKR_USER_ANOTHER_ALREADY_LOGGED_IN",
        261 => "CKR_USER_TOO_MANY_TYPES",
        272 => "CKR_WRAPPED_KEY_INVALID",
        274 => "CKR_WRAPPED_KEY_LEN_RANGE",
        275 => "CKR_WRAPPING_KEY_HANDLE_INVALID",
        276 => "CKR_WRAPPING_KEY_SIZE_RANGE",
        277 => "CKR_WRAPPING_KEY_TYPE_INCONSISTENT",
        288 => "CKR_RANDOM_SEED_NOT_SUPPORTED",
        289 => "CKR_RANDOM_NO_RNG",
        304 => "CKR_DOMAIN_PARAMS_INVALID",
        320 => "CKR_CURVE_NOT_SUPPORTED",
        336 => "CKR_BUFFER_TOO_SMALL",
        352 => "CKR_SAVED_STATE_INVALID",
        368 => "CKR_INFORMATION_SENSITIVE",
        384 => "CKR_STATE_UNSAVEABLE",
        400 => "CKR_CRYPTOKI_NOT_INITIALIZED",
        401 => "CKR_CRYPTOKI_ALREADY_INITIALIZED",
        416 => "CKR_MUTEX_BAD",
        417 => "CKR_MUTEX_NOT_LOCKED",
        432 => "CKR_NEW_PIN_MODE",
        433 => "CKR_NEXT_OTP",
        437 => "CKR_EXCEEDED_MAX_ITERATIONS",
        438 => "CKR_FIPS_SELF_TEST_FAILED",
        439 => "CKR_LIBRARY_LOAD_FAILED",
        440 => "CKR_PIN_TOO_WEAK",
        441 => "CKR_PUBLIC_KEY_INVALID",
        512 => "CKR_FUNCTION_REJECTED",
        513 => "CKR_TOKEN_RESOURCE_EXCEEDED",
        514 => "CKR_OPERATION_CANCEL_FAILED",
        515 => "CKR_KEY_EXHAUSTED",
        2147483648 => "CKR_VENDOR_DEFINED",
        _ => "Unknown CK_RV value",
    }
}

pub fn get_ck_attribute_name(value: CK_ATTRIBUTE_TYPE) -> &'static str {
    match value {
        0 => "CKA_CLASS",
        1 => "CKA_TOKEN",
        2 => "CKA_PRIVATE",
        3 => "CKA_LABEL",
        4 => "CKA_UNIQUE_ID",
        16 => "CKA_APPLICATION",
        17 => "CKA_VALUE",
        18 => "CKA_OBJECT_ID",
        128 => "CKA_CERTIFICATE_TYPE",
        129 => "CKA_ISSUER",
        130 => "CKA_SERIAL_NUMBER",
        131 => "CKA_AC_ISSUER",
        132 => "CKA_OWNER",
        133 => "CKA_ATTR_TYPES",
        134 => "CKA_TRUSTED",
        135 => "CKA_CERTIFICATE_CATEGORY",
        136 => "CKA_JAVA_MIDP_SECURITY_DOMAIN",
        137 => "CKA_URL",
        138 => "CKA_HASH_OF_SUBJECT_PUBLIC_KEY",
        139 => "CKA_HASH_OF_ISSUER_PUBLIC_KEY",
        140 => "CKA_NAME_HASH_ALGORITHM",
        144 => "CKA_CHECK_VALUE",
        256 => "CKA_KEY_TYPE",
        257 => "CKA_SUBJECT",
        258 => "CKA_ID",
        259 => "CKA_SENSITIVE",
        260 => "CKA_ENCRYPT",
        261 => "CKA_DECRYPT",
        262 => "CKA_WRAP",
        263 => "CKA_UNWRAP",
        264 => "CKA_SIGN",
        265 => "CKA_SIGN_RECOVER",
        266 => "CKA_VERIFY",
        267 => "CKA_VERIFY_RECOVER",
        268 => "CKA_DERIVE",
        272 => "CKA_START_DATE",
        273 => "CKA_END_DATE",
        288 => "CKA_MODULUS",
        289 => "CKA_MODULUS_BITS",
        290 => "CKA_PUBLIC_EXPONENT",
        291 => "CKA_PRIVATE_EXPONENT",
        292 => "CKA_PRIME_1",
        293 => "CKA_PRIME_2",
        294 => "CKA_EXPONENT_1",
        295 => "CKA_EXPONENT_2",
        296 => "CKA_COEFFICIENT",
        297 => "CKA_PUBLIC_KEY_INFO",
        304 => "CKA_PRIME",
        305 => "CKA_SUBPRIME",
        306 => "CKA_BASE",
        307 => "CKA_PRIME_BITS",
        308 => "CKA_SUBPRIME_BITS",
        352 => "CKA_VALUE_BITS",
        353 => "CKA_VALUE_LEN",
        354 => "CKA_EXTRACTABLE",
        355 => "CKA_LOCAL",
        356 => "CKA_NEVER_EXTRACTABLE",
        357 => "CKA_ALWAYS_SENSITIVE",
        358 => "CKA_KEY_GEN_MECHANISM",
        368 => "CKA_MODIFIABLE",
        369 => "CKA_COPYABLE",
        370 => "CKA_DESTROYABLE",
        384 => "CKA_ECDSA_PARAMS",
        385 => "CKA_EC_POINT",
        512 => "CKA_SECONDARY_AUTH",
        513 => "CKA_AUTH_PIN_FLAGS",
        514 => "CKA_ALWAYS_AUTHENTICATE",
        528 => "CKA_WRAP_WITH_TRUSTED",
        1073742353 => "CKA_WRAP_TEMPLATE",
        1073742354 => "CKA_UNWRAP_TEMPLATE",
        1073742355 => "CKA_DERIVE_TEMPLATE",
        544 => "CKA_OTP_FORMAT",
        545 => "CKA_OTP_LENGTH",
        546 => "CKA_OTP_TIME_INTERVAL",
        547 => "CKA_OTP_USER_FRIENDLY_MODE",
        548 => "CKA_OTP_CHALLENGE_REQUIREMENT",
        549 => "CKA_OTP_TIME_REQUIREMENT",
        550 => "CKA_OTP_COUNTER_REQUIREMENT",
        551 => "CKA_OTP_PIN_REQUIREMENT",
        558 => "CKA_OTP_COUNTER",
        559 => "CKA_OTP_TIME",
        554 => "CKA_OTP_USER_IDENTIFIER",
        555 => "CKA_OTP_SERVICE_IDENTIFIER",
        556 => "CKA_OTP_SERVICE_LOGO",
        557 => "CKA_OTP_SERVICE_LOGO_TYPE",
        592 => "CKA_GOSTR3410_PARAMS",
        593 => "CKA_GOSTR3411_PARAMS",
        594 => "CKA_GOST28147_PARAMS",
        768 => "CKA_HW_FEATURE_TYPE",
        769 => "CKA_RESET_ON_INIT",
        770 => "CKA_HAS_RESET",
        1024 => "CKA_PIXEL_X",
        1025 => "CKA_PIXEL_Y",
        1026 => "CKA_RESOLUTION",
        1027 => "CKA_CHAR_ROWS",
        1028 => "CKA_CHAR_COLUMNS",
        1029 => "CKA_COLOR",
        1030 => "CKA_BITS_PER_PIXEL",
        1152 => "CKA_CHAR_SETS",
        1153 => "CKA_ENCODING_METHODS",
        1154 => "CKA_MIME_TYPES",
        1280 => "CKA_MECHANISM_TYPE",
        1281 => "CKA_REQUIRED_CMS_ATTRIBUTES",
        1282 => "CKA_DEFAULT_CMS_ATTRIBUTES",
        1283 => "CKA_SUPPORTED_CMS_ATTRIBUTES",
        1073743360 => "CKA_ALLOWED_MECHANISMS",
        1537 => "CKA_PROFILE_ID",
        1538 => "CKA_X2RATCHET_BAG",
        1539 => "CKA_X2RATCHET_BAGSIZE",
        1540 => "CKA_X2RATCHET_BOBS1STMSG",
        1541 => "CKA_X2RATCHET_CKR",
        1542 => "CKA_X2RATCHET_CKS",
        1543 => "CKA_X2RATCHET_DHP",
        1544 => "CKA_X2RATCHET_DHR",
        1545 => "CKA_X2RATCHET_DHS",
        1546 => "CKA_X2RATCHET_HKR",
        1547 => "CKA_X2RATCHET_HKS",
        1548 => "CKA_X2RATCHET_ISALICE",
        1549 => "CKA_X2RATCHET_NHKR",
        1550 => "CKA_X2RATCHET_NHKS",
        1551 => "CKA_X2RATCHET_NR",
        1552 => "CKA_X2RATCHET_NS",
        1553 => "CKA_X2RATCHET_PNS",
        1554 => "CKA_X2RATCHET_RK",
        1559 => "CKA_HSS_LEVELS",
        1560 => "CKA_HSS_LMS_TYPE",
        1561 => "CKA_HSS_LMOTS_TYPE",
        1562 => "CKA_HSS_LMS_TYPES",
        1563 => "CKA_HSS_LMOTS_TYPES",
        1564 => "CKA_HSS_KEYS_REMAINING",
        2147483648 => "CKA_VENDOR_DEFINED",
        _ => "Unknown CK_ATTRIBUTE_TYPE value",
    }
}