<KMIP>

<!--
     Key Management Interoperability Protocol Profiles Version 2.1
     OASIS Standard
     14 December 2020
     Copyright (c) OASIS Open 2020. All Rights Reserved.
     Source: https://docs.oasis-open.org/kmip/kmip-profiles/v2.1/os/test-cases/kmip-v2.1/mandatory/
     Latest version of the specification: https://docs.oasis-open.org/kmip/kmip-profiles/v2.1/kmip-profiles-v2.1.html
     TC IPR Statement: https://www.oasis-open.org/committees/kmip/ipr.php
-->

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=0"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Register"/>
    <RequestPayload>
      <ObjectType type="Enumeration" value="SymmetricKey"/>
      <Attributes>
        <CryptographicUsageMask type="Integer" value="Encrypt Decrypt"/>
        <Attribute>
          <VendorIdentification type="TextString" value="x"/>
          <AttributeName type="TextString" value="ID"/>
          <AttributeValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21"/>
        </Attribute>
        <ActivationDate type="DateTime" value="$NOW-3600"/>
      </Attributes>
      <SymmetricKey>
        <KeyBlock>
          <KeyFormatType type="Enumeration" value="Raw"/>
          <KeyValue>
            <KeyMaterial type="ByteString" value="808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f"/>
          </KeyValue>
          <CryptographicAlgorithm type="Enumeration" value="ChaCha20Poly1305"/>
          <CryptographicLength type="Integer" value="256"/>
        </KeyBlock>
      </SymmetricKey>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Register"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=1"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="16"/>
      </CryptographicParameters>
      <Data type="ByteString" value="4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <Data type="ByteString" value="d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <AuthenticatedEncryptionTag type="ByteString" value="1ae10b594f09e26a7e902ecbd0600691"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=2"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="16"/>
      </CryptographicParameters>
      <Data type="ByteString" value="d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
      <AuthenticatedEncryptionTag type="ByteString" value="1ae10b594f09e26a7e902ecbd0600691"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <Data type="ByteString" value="4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=3"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="16"/>
      </CryptographicParameters>
      <Data type="ByteString" value="d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
      <AuthenticatedEncryptionTag type="ByteString" value="ffe10b594f09e26a7e902ecbd0600691"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <ResultStatus type="Enumeration" value="OperationFailed"/>
    <ResultReason type="Enumeration" value="CryptographicFailure"/>
    <ResultMessage type="TextString" value="CRYPTO"/>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=4"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="16"/>
      </CryptographicParameters>
      <Data type="ByteString" value="d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <IVCounterNonce type="ByteString" value="ff0000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
      <AuthenticatedEncryptionTag type="ByteString" value="1ae10b594f09e26a7e902ecbd0600691"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <ResultStatus type="Enumeration" value="OperationFailed"/>
    <ResultReason type="Enumeration" value="CryptographicFailure"/>
    <ResultMessage type="TextString" value="CRYPTO"/>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=5"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="16"/>
      </CryptographicParameters>
      <Data type="ByteString" value="ff1a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
      <AuthenticatedEncryptionTag type="ByteString" value="1ae10b594f09e26a7e902ecbd0600691"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <ResultStatus type="Enumeration" value="OperationFailed"/>
    <ResultReason type="Enumeration" value="CryptographicFailure"/>
    <ResultMessage type="TextString" value="CRYPTO"/>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=6"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="12"/>
      </CryptographicParameters>
      <Data type="ByteString" value="d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d63dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b3692ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc3ff4def08e4b7a9de576d26586cec64b6116"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
      <AuthenticatedEncryptionTag type="ByteString" value="1ae10b594f09e26a7e902ecb"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Decrypt"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <Data type="ByteString" value="4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=7"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="1"/>
      </CryptographicParameters>
      <Data type="ByteString" value="4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <ResultStatus type="Enumeration" value="OperationFailed"/>
    <ResultReason type="Enumeration" value="GeneralFailure"/>
    <ResultMessage type="TextString" value="L_KMIPCRYPTO_random:invalid-tag-length"/>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=8"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <CryptographicParameters>
        <BlockCipherMode type="Enumeration" value="AEAD"/>
        <TagLength type="Integer" value="32"/>
      </CryptographicParameters>
      <Data type="ByteString" value="4c616469657320616e642047656e746c656d656e206f662074686520636c617373206f66202739393a204966204920636f756c64206f6666657220796f75206f6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73637265656e20776f756c642062652069742e"/>
      <IVCounterNonce type="ByteString" value="070000004041424344454647"/>
      <AuthenticatedEncryptionAdditionalData type="ByteString" value="50515253c0c1c2c3c4c5c6c7"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Encrypt"/>
    <ResultStatus type="Enumeration" value="OperationFailed"/>
    <ResultReason type="Enumeration" value="GeneralFailure"/>
    <ResultMessage type="TextString" value="L_KMIPCRYPTO_random:invalid-tag-length"/>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=9"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Revoke"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
      <RevocationReason>
        <RevocationReasonCode type="Enumeration" value="Unspecified"/>
      </RevocationReason>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Revoke"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

<RequestMessage>
  <RequestHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <ClientCorrelationValue type="TextString" value="CS-BC-M-CHACHA20POLY1305-1-21 step=10"/>
    <BatchCount type="Integer" value="1"/>
  </RequestHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Destroy"/>
    <RequestPayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
    </RequestPayload>
  </BatchItem>
</RequestMessage>

<ResponseMessage>
  <ResponseHeader>
    <ProtocolVersion>
      <ProtocolVersionMajor type="Integer" value="2"/>
      <ProtocolVersionMinor type="Integer" value="1"/>
    </ProtocolVersion>
    <TimeStamp type="DateTime" value="$NOW"/>
    <BatchCount type="Integer" value="1"/>
  </ResponseHeader>
  <BatchItem>
    <Operation type="Enumeration" value="Destroy"/>
    <ResultStatus type="Enumeration" value="Success"/>
    <ResponsePayload>
      <UniqueIdentifier type="TextString" value="$UNIQUE_IDENTIFIER_0"/>
    </ResponsePayload>
  </BatchItem>
</ResponseMessage>

</KMIP>
