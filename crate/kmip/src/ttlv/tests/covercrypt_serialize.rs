use cosmian_logger::{info, log_init};
use zeroize::Zeroizing;

use crate::{
    kmip_2_1::{
        kmip_data_structures::{KeyMaterial, KeyMaterialSerializer},
        kmip_types::KeyFormatType,
    },
    ttlv::to_ttlv,
};

const CC_KEY_MATERIAL: &str = "a20f6335281e680de32476e422768f137ded79905f750bbadcbd2c563714400b0266706696a5b030a465aef6bc0c5699bd91144b5490ff0fe89faabf996b8e540f6073064abdf00b144443f30e1d3eb304480fff94daabd278b5e90a2a68b3fc29415c62595d15200fb6d82ee0e0203b02efe02eeab1a142dada2565ada0f90803880674f9de04b041c1cbf5354491f7326b302d8544990bd2fe2566427928c961001401000101010b09eb1cc56841a37060be2d54f1ceb57f985b4b20919e5ef73e7f3cd7fe0d006ec2ad44b009199b9c5d639170522317795953340abdf88f207b190ebb685c1a69c0ea34c5a502f08c6581c4936ca2c173f93438cb57ff0695ce6080df846e69dc2b5bec90acd713dda94a47d7cad229a457415fe3654358701124812003f19174114f7938111aa330aa2a5146c123e6276cef535fed3666fdfb55d8e639762626ec2672c600974556433c0c373a0416c95492f987765ec72c0a28066498af1002b69fa4138618464f047cec7950ec6915d3423aad83c1d88b2645056828011d63e702c1d0919038431c0ca7b8f168d3298236203719d4019b28167ca26cd6c7b56a0546f9c59629f315513c2f1f0a1151b82f3c296b5b9b270553ce8b701dbd47b5f5e4174905aee2348fa4ab18ab17c2f3f23d9000c3476709e0fc915ec4c3795b542517add8e033e8b825ae95636d3a353f1b6fd7ebb62ebb2bbd40aefe6a0b9c0a8ec2b3b2d2e6be63a2256f18a04f2c7dd859ba64e7b961b299ee0b27dd04a877d065e4f0321b89bdba3cc491a54956b445cb30a78d418abaa766e6b164ec918d40ca4d05897c2b3323dc0aa5ee9149ea975db5684620e273b36188dd89843c799bf2658e1f006d6ff9a8e5e952ece994c6d3217fcc97a6073994d0ae55d0a8d42642836ab97adcbee7dab43c391799807e63e62f0f71476aab9aa2760990ec37f2f81b6ca97e192c3fcaca1964eacb777bba074329f168a2c1b552cddb872a9590064b51599c22cd274b0a774ba5945e1459c7ec3a29561459dc963b1eea4c373b41c237378c9a3a483295808999ac82522841c7517c446a54a082a87c94f9a05791a745067f451c9a28ea3958ec5d4f67574dcb22b1106f3c582701acb915911758b6332063600f6ca02c4c64d7ba5d732c6e498437e4b030ee1114b3cab7d1099b1ac03752b1072b93cad36c8a5c58cc0520af78e399c38c50cb597911865cd23ccaafb89fe7868b3f8c02a174779cb50b5b5161def0680b87a1b5e27cc6ba59a211129052c284972a7f1bb9607c88ef42afe6b2b24cb44e3ce902b55402135b70cdf25f7b79457634331a8c4ca2c2a46a09b5fc6c03ff652cb305830f5701a79a8820154c77e5c2f6345fce9c97900ba7d85960a1fc74c09614b86a89baeb344f65bc60212a293a9c5a6c6386817ca38528d058b9bb8aa1b817b165b6328af77b9978cc9913964f68b6206b8ee070b4e139843c01c7bcab78a6c13afc5121b26ccb220bc23501880e46ac433590ef4cabd5005590b3a36c708d263abd8ae7ab1348a91cc6542ac9a4c8d54522855d30b770962b94b9c748ca059af8c05fb017402122c9dc046ae0873eb427520b63443d33c4619383bde0259196742df42966a62d9625708a642eff49be52463c0516661f6915f8482287c883649623c0622a3a9964cbb0ac250828fc4407445a8daa19780b03155b8a98e0886769f076c810baf364cbf4825bfab15478e4a68713244120708ac4967ea5352618021a2249944778bff4463f423ee0e7989087a5a003952e67a1f0ab7810b8c15bc43627c6142467cb7d25aa1650404d0c450068a99731b1f156bac0d4a3d140427fea89641cbb6faacb4fd52943e8b2f8953b758cae0d99a4685b948967ca992c926f7744abd378f405b1cfe48324f9bb4217c207b57b3c1604f4dc73df2695e651600705513fb76b82033a1828c92603a541928a653c6915e0300968b8dbcc37f4a085d4d2cf56639c311111e092cd01a381a6608ca3a059e3ca01fd684470051f532800039094e7679358c173ab7bad8e1b1f5b09697cb72de8cc38e5597ec572ab18d32598999ebf4853ab4b7a9a769b35710461732c5bf3165b5b055749a36724be714c626ee94d9d9c6179b900280575b1d415175779a8d3370da88f4d3a0b9de46458c096bf781b63e7a14077b3e55b26bd5806795027be18a2e7ca4ceefba377d2ae3fe5bee1f243407a33751c443b499ed665ad9b4897b37c382b1623cd76cdb7bb74f826407af74d8d2b4a364040b84b80bb91a124a408639cc0f78bce27a324b42b8649087f33ea6901014a4d429537a22fceb3ae7bf424fb489d867a2915802d81d9bc3e7820bd252c43d1ccdbbcc7314712c3d0270e171e4695152e7c427a6c02da781634717261037619dab4bc00ae5b441d934207c3f91a717524b2ccb3f1b510720f6ad1a1e8b3a42a06c1d86c60a4e5d2f35ab733b4304a8d575e23eaca2374aa51b84f1aa3a58398b86cdd09c715eded114645d6c21434e6d082a5892d163ecbc31293ed9b61798a9798e7e26e588503925f8c0144300c1a980105010100f88c3699f094dde22103c8159260251a86ab8f011fbf129e0027592850fed50701040101005c16325a29de903d04546e098ebbdd8750f6d121fc9191a54d0357f5623f0b0a02010501010028efd37cc776c7f594041599961d4268e8d5eb973961b8ae700ee720ea542f01020003010101cb83c1c4c0caa477a3bfce7b8408ed164b261ec7137f389f3cd6e66e098ef307d21855e3903af35c88c63c7e47d32a3132ab6ba7c3cb3a4c059abe72819d4d34759d48a1eb0ac71f5768a9c6b381ca8523a70aa19c8c3000ab8a718017db0479b83d24d2a88cf76240098e7d0a6aa1a6bd59f91ddd01bf956024e3ab0886e8820187b60645c6c3103d75f96770897e46f596fd80b4f9c9c167a260dbd12f829a2c78fb3a548201c3f5a5910c8edea7696ac353b0b57004c3201d22cc98f3bfa73272021849263b42de90615e34c59e89cfcbfa9524a40c52c5444bfcab4c0891a8e170293b08d92728212bbdc94925ad7bb0ab5640705474af818574f3837da252a6686ff3637d0e2665d055ccdad35a24d163e9bb7a366828e527be21f7cbd378bcd6fb78b9ccb3a37b891d67485442cd0efb12d5f3b14b1165a554270c9c50ebf7c9ef40cdf446c8415b7589606c05a34a379baf51f410f5a114a2d215977bbbbf82539234b7f5294b6736b108100133b2b62073b735d130df1a40947749efe9acca124f995bbb9e36be902a7706f33192dbca21c3770150a3f0796c2652983fd24cabfc69419449c64672f9f7c6cd5b3419d76b2455b889bca046689ee1e412a944279412b903a77083d977e9838484a5c14d82659dc90367798b44e0546b2435ec7785fd2938fd7a17e3085f74e952c64c677715916e1844eed53ca12a3373c98f1832a634cc10bbfa97fd377b5a20862f6c9c2f431e58b5cb0d660000cbc6e0f1883f720216074729f69aae9066ec4c52a04249a4c51e58055a40e50cce4481d4930cbef2b3f1cc4f5a6026c70b2483012285fa9aa3d11801f008f37574fcb8150c79479f6709e7e74d88346fbd506a8943257bf4c6a7708652dc8745769c7c532adbda50d348242ceb3e0aa812acd84b8bb363fdb44eb35451d41735748153f97173c208a4e3164d279cca4ebac35cd203c0700e9a46cb3fd1b3928a43122c01a556b08118550fa4c037e2a7a3da401de370fef83cbff13a3534058ab2c6dcbbafaa8126bf37a4e53b9292a26236c242193892e12c1b8ffca5897470a23ab7cdc109281a39e372b3020957ae507af210560fecba25437333437bfc5280a8f0aabd318561b9b59bac3cd8707f75f053ca433f2c304e55b80014d74ffa7789049a07ed5c7fd16a6c099933fd4295a38685ea30780da7b12573248e47b8d9fc8b3abaa3fde7373a064c097a8d13fcad57b0437178baade718c3d005b9288cd1bc64192aa6fa89524a8c9a4870602e5988695361c806cc81cb47dae13e1bb61f408acf0da0c7be318742d2351ca620dc845ba59b535cea8c18f55e4993a2bc7796cf1556683645e6e615885264b64c942ba102e362aca8c61148c073551c6067322dad0053f34516ad6a8156ec1013fa6e56b6abb7fc3bd8972e3cf743d7290e3b199b9c2a91a585053068834e3c2b14fc5e5cb68e3a65062a475c7145912767682be30dda68a756745f87a1b2dd6b2cff850fed7c0a31174b7bfbc92ad34509ec40493608ef07cb40047739cc1b6996bfee1cc99e806385e64922f66c95996f0b6aaefcd506c2c1c0e16a956f0c890b04d0aa93707d488267099325b60ff6640c9a546652464d9129b4abd681cd54934aaaa92dfc3c2e22c3a8f59c29750c08418e0a9b6b4cf91c1f927d1a384dad65a4f11ab999533674c2041eb17af54a75b25068d0713570541f8ac7c51a8427a9eb3cb9f27408061caa4a84b6db2cd7bace176ba401221354906bc1a56442906792dc015d145aca7467e4d77515e31071333d5b2343c47772c20132ec693c6e9818645a5d513625076021294b58a44822f0b1aa0a94b8d46934a325cee1bcaf2be1147692ac0a9a2bb95a3da84c76294b396e695a80b6c1a3d216cb6060198934d8fa720c179f0dc8780c39b429a6c1e1e2b168229065120b889aa347703bd5e5733da327756b15115a8e14b18cee5215171c51656a5815778fb75426d5e5b28cf17ff6d68f61a25bb16a315e01b3aaa2bbabaa929ac556bbc395eb766f053662639669c973514ae9245cea622785203bf114520488e7849aed21be70843987e1328509a87e7bba43495099f01cc24bc47bd03e187cb048ec470cd250419764b74614295a70faeba3d2485145fc8ee6e01d583cc067f4700334185d1926ca1a58b5622e4fec91a7f9a181b9746d0c5f5dec5e8ba7c05eda4268ac366649eeb453ec56e925b2230199dd180e6e24770dc877145823ab935a22c13134f18c8d0e713e31876f51d3592324e094e2210ee415a99e5b1adf58ba027e8825546beb17416ac337956e02e04af24cf0f1b14510020205010100f3d9494e96040400488a8c8c4f56c3ace2cbc86e5eeba670f0f01777e78afb040202030101006d3447d98f7200c400312c44007ec8cdcbdcaf76506bf00adad2cc0be8b7b301020005010101dba27a57a5b24048f48fe914d07493f820ec90c3139d88ef1c4e95649d05a60c8b22139cd957fbc361869b7e29a70ca8533f590a7a0337836fe09906d843f1423a3bfba8b5c39f22e43ce820aa0e7928dc3a0214b44f5ec8682f502b707848b034c9f8054cc13ccfbca7b682b05f20d91283d80f87d528d59351b2283ff12604ded2303821a334376821277b7951406ceaaf83f2a50b0cb83d3b1ace33b99859b7b6146ec15c8a6bcbb95867836e4b3c492888faa30700ab099ec03b178a635c640e897ab67acca352a8c6bd95a8d25c4bbe530adfab65b7b39bef55cba6d5bfb5a0a62ec3114ddabe0a8268c345085b17388b025a2c421ffc981d29a60696ab8fd1c42d8ec92116d893c6983a67d995544795b66b1bf7c45a5aeb4a29742b90f4282fa194d4a300ee4a22ee4cbb7b829c13a862ea0b199fd918a18120e94c81d6b6932d12ae681606df6c0c8bf7a9f18671529863aaab8dbc1478dcd30f0f557c3ce32a2c85955b2073736cab3e18ad2b442f0f07ba9e0353e7e348af0ccf617c2044a177bdf8cab86b6f7d157ac0b2c780989b6699ca15a34211ec53534b1b6ef9bdb7382a6a398c932208669b535d71c1de8260632084008c80dc1a248022c4ce8b3e34b8c68b36bd28753ba9359459a26473895aa573b6b46b5553fa645fbc0cfbb92d06d88881a9c347e4a237a7cd5fc032c3853d79517286f70c93a295087b951547324f30617be4ae26815804c89ce3f57aa075c0f9a52b667086573aa002c2c803b279a2a53a4343a650e6391b47b27d12c1c5b4cf58f65288fb39a935a9d4f9078887c3733610039b30039a7a9b4b65a6da3a7985578a9918b56785289545b6d7b187731efa935e215c6678849872943392a03546362822d9a5f1821f2703300c0249a741a51b665ce97926bb3912bbe32ffe658114d1b90d10330e0b600002d09b266883db874fc84136ca551c043571c5b309d8977800c5ec423e8d746db89ca1ab56cc0542615e832719684713a8b40bb248a623074e5305cb958a27d7bfca4229d2192254d58237951b07d84ed281a7bad46a70c17768d3478c407cc1c4039d01665c768855e3c022a2391a055202e50f7aec69c60c188ac5aca0272470374f25c8baa90557fa7a3c3ea243e00b36ed2c7f13a4885bf749f414bc88e30da653c6c28645d9f3083d5a820fe90ad5cb5fe3c5886fa41f626602e1e10da317809614306761b0fe60698a7633bb2cce1c50977500bb69b6832c27b680b590dc7c322628af99ba1523b952d937a5159a36000ab3920b3d7378ae3ea00ad1d886a4c184b1f4aebcea06ad034a82b886c64015904289a5bb6699c949d36938ba49cc2c5b7189380d64e287b5c13233bb8b77229c85e7c6b2b3301468c9c0c8baafb22883eccbc5191a0f47ca85e62854b8a000c2c11648a790f39015e5a211d2384cf0167ba342d56a7aa323a562859111819df7069c9e329889527a79835464ca176518760b846d6f93253230ccbe4c974abb7a0ae905572387e92278afb51420828cd920abe09b806d4141fba2b79d2c4a5d03a71b346404ab849c88959882635dd6cf289b40591b4b428b808843b65159522192116ee7bc27cb17b7d31e24f87c99d048a2d61735089f9ff50194489fb9f6378242055a062c7dba8a973870b5ea75511a7964e4bf6a79aa962b9679b0670ac42f36060f911276101995e1916bd447944859a78df58ec33aa17830b6cd8981efa176a154c5db12cddb36b17395cf18e755e77c0142ac765c727555271c1410b222c4558120141a572d55a43d1295228f65ca5c41a00f821e0a368b180bb5e3198dc2c7266e91c3eb71ae65b161ba99646ce7cb2f733b9de93ab297cc92aa961848836a56a7d574a7a8646d05950f064c870de37c44215de78b4ab88a5a6651228e9bab952312da521cc075849d282f37058bc046b296e1a66925975ca32529a0c69128897e1c42d796ac08ba55c91c48b1c7915aa37d339b358757b22f2921572c88af7ba5a2057719425c63db1b2ab3bf8924c0ee7a7f1a936e5a31480baac4d6406b21cc44b817012f82b62ce63ccd66099b797c19e1454e4896a3d6ab2a6c1e5a40c2af77b2da81c032a16f8ca3b6c7a906c287cb1acc8b85b57df7156787382463201407ab1ab88b8f40756cf773515cb3728f9bbf41256f7424bb56fb5502c03498b73db8d910516a756983b4b703a84b839f62a98ca9b012ee86858870b37de34a597bbf80925e6ad15978cabbdef2b5dbe256c0cdc9c9038ee1e72cc4107d6bdd224909b0bfb68365910572428bde3c25bad1b922e7ab3dcbf288785189b6f7396373d9018a0200060101011930352fc57c5761d5700f6748cdcaf6183f4afb6bf6367ebd7fa29aec9e5001f4145c770bb860e20584194ad6273accd6a2d84822e653ab7ab5c70197aa227759590b1bed8a97e295bb1d93045dd48698f130d1ab9716e39022257ebb42babea29f8e35a8a94bcf072782d05598defaaf6bd2179a156bd5f290b2f000090498fbcacb7bdc7c63580e43bbc7522b5aaca65183b4871b89ada847464c5caa9a488881157a9492517737aa15fa1e83f2c248cac74395317706b9c0918e6ca715882c2b4a43425db80dbe62cdfe4a71d4da3d3171187714653e3474bf969f5e6097d6d55596f0629653c49ba19199677e034c594b97341e535f529693bbcc81e727740821af55d78a65a6b1a3205079124a158436ed16a706710acc61cc82d46f6bea6c6fa68c34c959999b52e394318788caddc95ae01c46353427e9a933787a085bb82a7bec515a832801eab76c2a291fb6a2fceb4d847126b1f59c5548750fe1c7ac6578b6d48d005ccfec412e7a88271133c452353d32595fd0b171cee76d370179ebb29bab930afd69940ca319b2c97bdb9982ed6845b5fcaefe988fe18844a050058eb51390ea5f3304816656140fc1a3424300cb968e208c518f583dae65a37c039d31e573caf8729af8807897584625871143c0b581349b825aa242c90a503dcb83b0a6f1a6bfcc67daa138ab79384b035dbdd58139d2abe1f7218a816eb753ca156265b42442dda73c580910e0cb8fa2d199a0497b0f53a784d66abc8a31752c058fb638989273b73c42632386135bbbd419b08e1798e41326a2fa315473a083240a913c382528916a55b09ac1bc6bf4afd70c821146cb005c825633c951f604a465a5753165b68bba56f24d6c7ac3d9c471ae1acf55c386cee51a4b6394ee4938c45360204bcd72db98cda46f0892297666943ce63fd6925907492fa8b98d275b345e5551efc234d4873bcf30707505a551caab8bd52475c04c730ca5a92ab7de94a6b59235de1c9639603f6a54271318080c5c49d9490f77bab319e240fc063eb7305c27406a2e5911b6a699b0d50a239c54caa4ca801197191a8466122c221116c26085f8b32740536589286b264701d6ca2a1b0aa8846c67c920b70bf569cc36650a924cde555ac840c674a2536532819652adf4236639888990e337c72c161b5842ee947e50b93b66a2ad3e2519e337644e639db4f6cf1bab6dd6ec6f1008247d315d60b64677072a1d2b47d8c24a5a3bada7a1454c06a63e980ec6bcc82a199cbf697e57e49d844755e59bbe68d55ac0bc811bc0859ab2b9995219bfc12c855840d3acc66829391157a050ca0dd19339c4327f442016e50c6e5577b679e91d8322769b69aca939a74e328cac5109e4a83efcb55c5544cbaf1704d1ba5f45ca432f83be54f8464927cdd025176a69436b14320f05aa36d47752c891a23377f9eb8ce387298d63a5c5b25dd6775f7d9b8d6f8749a16695247c7ba2bb5189fb6b54e453d8157f29328901a75d14b2bf3fd3417e2136e25c9e76d6723603512b4c983303a0ef4137f5e7166efccf87e72dafb30c09563608217bcb4139b84716b9eb5a34d28cf49a97b450a354d30b3e74110abccf37d411061955194389ce736adc827eebeb0e06914c18781db1a76912ec7c8a9783d755625cecac0a041035e99acfb33e49431e55912f5d79b7ad1b5f32d3a227b788a602a8cc6c73a48aad4895468534abdcacafbd38566d037c5d3aa8063b1db756450060014226131e90b6296c4ae078540813bd0532331f11315a2801e646cc6e472560c31655e3af4c688c310742f580599f18c76f86bbe1b8b9c55ca74c985f222a65951b45b21703ba65791fbb30717c833aba0fe5aabd4e43c769828694e59c81b72d17c836c340a442737c8717696ec1bbe9321d30233a8e736782e0992ada73fb4b30ea98cf89cb64d1e275c8b6307f295c638020e0c132167927b0162a88b36167031f9598445a85b6ddcb4d08aa0d9362878e306cb835b7c88a12c0e694bfc7c7a43bc57f9a397344b70394c0782620c802080a4108d76a8a5ed6ad9efa7439a8cb58316357143e5ee887bda74bf615222488864f53a171e89d30dbc24286c6935948b82bc19aaa39a9d6432b748a06d4c9ef7534070c45fe43879cc19f12338d1ac79c52121154485f33d1558b992903e0c61f052b0178c2d3d40acda8957552242ee469199064dfd750b86f8a364e09938020266b183189b5831c8d5103b9f5379c6c5f55b217172dca1b08d09c9cf06b49c1a2ea072049b8bf574678734dd795e54e751986d5cf07ea8f342e8d1e652b769c3fee21aae6991e7a9d695ca7fdcb020104010100e8bedbd091d89bbbbe8844508b1c1b9081bcc52244c4b959ba4805677ae3de080103010100d8c930b9e72977056e406a545f676c2adc839699f58f58305b55ee749600d10a020103010100f205937a7a0773a8470f1715213e308ac74e3312752a49a3d64885cd26157e0a020204010100680af1d316f133d48c7f52c7447b2945359a1dd2bcc1e37a38980c790bacd8060202060101002289bcc491488369661f6be8a1c3c5d86ea9e6382b64db9a54b819f4e6efb90402010601010001729d269050d2bd35db6548b3b787908a492c0730547ee2d93c96c7f34d8f0f000101007df95485730a6b061b3c0d158db9e9dd60465f4c37e26f422889f6aeb632500d020004010101bf8957bdb6861899514272c3b1ce93ca1591172c8cf464d336e0a16f5b29ee04a2413b5888351eeb20e6eca63cbcb1fd3218a2b7518fa4b8cc370fe16bc95f809dbb936082213fa5b7c93278a0f861537b92c10124a6115abf6a7245d6581a55828c5836797bb006a698cd7598ce40916b6d26a3802800b9a3932a64734eb9a16f0b2dc349807b285fa3f662a54c10239b398d49c6d63aad0d52298f5b3770566601f2cda122c37ba89d5f8917d704025edb031d0880fab7a985d99c7592b955a89b1261a0b39b153649914d60be9e5225dbf5256b71773a60825e1c2f90a3ce25295b07143cc34c02e700acf381065c1ac353594bf39056d143c86d815f53cac021686bfcf2b782397e15d7a3d89bb14150a82cb98d5c122b0ec95d44341e04fa3752618b0cd54cd3a93b3331531e41c645085843b236dcbb3681ccca1387ba572796fdd43550b5a461846f4b44285a5cb4353a9cc33aabfcf419444083896a3b5d121f7139a7a2e5cb11008625c53fca84554beb99b4040f67420d87ea791558c8ab0a7535254ac0f7a01a289001c91c7f3849dd231e9543b7376c99ffe63562c32d65d058f8e84d23947d13c55e1b4b5526d34f0b86044ef2b66a66c8ca2235664a69607b1d8dbc326d26499ce90b24d460fb809da51c1e708329aeaa757f8817f1b070c0d9af72b7bb336c4808095754029261c35044fc6e35da5044bc6d6fe3661d8cb186d4c0a392a40d1080da7244cc01998252af7f2977c26322f6ca933e867ccc1984148b7285f625c0a1860a55a36ddcb089dc955b17451330cf99b49c21847fcfb2a80e24b9fc4270b8e32f6722374100a41cf168d48c5d770657100c07d1364b4911279cd13c10e8190d2ac957032e7cb320ac01b989b7a99661bd0030119a8acd8591177cc9a1812c8a65bc603ba90532b52c76ac0410cac5573789e31cc125d59b1e6a9481160903d79df2e6cff155a9b86677bf1b76c3e9c119ab0c49294e8f3c24a2e0a65d789f8a9900b5051a738999432205276480e8c65552fc6449f7484f612f94f598cb353e0d7611779963acc1b7cce314d9a321be80770aa4616e9acb8f540d4c71b8c9e7033ac734ba568df9780871f627c7b91dcaabbc3e48cc9a343a38ba3ec5a27d8a8b51502880b0b64e3aa399c0f0bc92bb9785987726a8abf3dcba42ac5b833111083c9fdd9c7cb2ba6459013fe30ad089cc788d96c8baf6cac6d51d846550777428c8d1cc37392f2f1529d2e9a8d0206648e672ffca655842304ffc2b22b1b5b7d33f5dd687deb65bd3f69bd4e58de8e788e59a46de32431fb3b36e8333b1ca337825524f86ab5c553eecb0199618adf51b249a7cb2f2f2440e8219724b7da19059a8c2aff609cdb50196a0f3485483a920da2cb372b30da4a03fdb136efb7abe099d939b82896b5df22680cd381e4748a08d745cfd9070405205d837c2b91344db314ea8439bcdf36e79d01a774c743327227a44b82f53b19c167174d410838b9534f682e523ccff200f0d9b1874110a51253a343ab14517bdb7baa643894dfef64dcd4abd4f62385928a704b86987f11281486657201cf4aa0cc28369f823ba97654bcf433843c9c8b3fc647d8333d7353560d738013123552a7492a4885899b869d527d5c0481e4844c6285e288bbead90af8c85846c0abc5621598563b9ada2a6e857ca5d3983ee5a0c2cc5378a681b7a53c77d8604e0f10b9a8494728a6dc5911c31005d9827cc13fcc92e046f7311a0436c20483091b3496f298882c7aacd043312be36c1264321ef166adf7ca33c26a2e85840fb51c67e558549871e8ad8c91dda2e1882ce892a3ade403b7d4ba31469485b70870d9cc6689a0dcd3cc9aeb9490cf3b754e090ab491ee561ba9297a0aef69b571526a7268d4d077ac4c79bfc8525ab3a2527f793d0b74b8f1b938a150997f84442244232d154c109cd805cbe8d0b183da4811c27a8d4587589b947b49a2f9390162fc105a182072c3c66b122a01a654fc64005bc5494edabab0a66552bd4462d2baedcd8bbab735c12b61ca961bf9da373146b3e02f76a0f0b1ebfd18d285930e2f021c15735a37816d91045f9549e9dfc7e20609c027298b26409a40863f8431fdc45233e97c013ac1b50c3188971ace004a5be4293ca9b40c921996e343538a03083a67ff90ca5a14191931262118717a7518c1b94877b6741316df9d4d5af2ef4c3103d2a0e5d253f3e1ae7d807dca38a323b8c8a7e9b01824d0b444b439d0218b54608d4804c631ee6863a40080490657b7b573689abfdf88b006f80e0c109941c495a69b71dacba0e15d8405c867b7ef5e3147965e463d10101010100b2d500d35b38f0e31e4657601c0d0989d3d9ed582c9ebe91ddf737f8db57bf030102010100925a522909c355f0369031cccc066bc555e19bfbcfff0f8e45b6f953b0659b0f0106010100afca2e544921d6aee0d3c61e498a270c16c71e10867c3f3ab68187732c550c02bc0d35f1336394629a4988288c93e0e100020e5365637572697479204c6576656c01030950726f7465637465640200010c436f6e666964656e7469616c0100010a546f70205365637265740001010a4465706172746d656e7400040346494e030001034d4b4704000103526e44060001024852050001";

#[test]
fn test_covercrypt_digest() {
    log_init(option_env!("RUST_LOG"));
    // log_init(Some("info"));

    let key_material =
        KeyMaterial::ByteString(Zeroizing::new(hex::decode(CC_KEY_MATERIAL).unwrap()));
    let serializer = KeyMaterialSerializer {
        key_format_type: KeyFormatType::CoverCryptSecretKey,
        key_material,
    };
    let ttlv = to_ttlv(&serializer).unwrap();
    info!("TTLV: {ttlv:#?}",);
}
